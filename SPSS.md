# SPSS

## 变量名

### 起名规则

1.变量名不能多于8个字符；

2.首字符应以英文字母开头，后面可以跟除了"!、？、*"之外的字母或数字；下划线、圆点不能为变量名的最后一个字符；

3.变量名不区分大小写字母；允许汉字作为变量名，汉字总数不能超过4个；

4.变量名不能与SPSS内部特有的具有特定含义的保留字符相同，如：ALL、BY、AND、NOT、OR等；

5.SPSS默认的变量名以VAR三个字母开头，后面跟补足5位的数字。如：VAR00001；



## 数值型

### 标准数值型

默认最大显示宽度为8位，小数部分最大为2位，会按照四舍五入与科学计数法进行调整；但数据的显示并不影响真正数据的存储，也不影响数据的计算



### 逗号数值型

逗号数值型数据其整数部分从各位开始每3位以一个逗号分隔。默认最大显示宽度为8，小数位为2。逗号所占的位数包含在总显示宽度之内，当超过8位时，先会去掉逗号的显示，再按照标准数值型的显示调整方式调整数据的显示



### 圆点数值型

圆点数值型数据其整数部分从个位开始每3位以一个圆点分隔，以逗号作为整数和小数部分的分隔符。 它的默认最大显示宽度为8, 小数位为2 。当数据值的总宽度大于默认的8位时，SPSS会按照上述逗号数值型的显示调整规则自动调整数据的显示



### 科学记数法型



### 美元数值型

主要用来表示货币数据，在数据前附加美元符号$



##字符型

由一个字符串组成，显示宽度为8个字符位，不能进行算术运算，并且区分大小写



## 日期型

用于表示日期或时间，显示格式较多，有dd-mm-yyyy;mm/dd/yyyy



## 变量名标签

对变量名含义的说明，增强变量名的可视性和统计分析的可读性，总长度可为120字符



## 变量值标签

对变量取值含义的解释说明



## 变量列格式

用于改变变量列宽度或数据在编辑窗口中的对齐方式等



## 变量缺失值

当分析过程中，发现收集的数据可能失真、不合理，此时需将其对待为缺失值

SPSS中缺失值三种指定方法：

1.对一个字符型或数值型变量，缺失值可以是1至3个特定的值离散值

2.对一个数值型变量，缺失值可以在1个连续的 闭区间内

3.对一个数值型变量，缺失值可以在2个连续的开区间内，并可指定同一个离散值



## 变量度量方法

数据的度量方法可以大致分为定距度量和非定距度量两种，对应的数据就是定距数据和非定距数据

例如身高、血压等为定距数据；而高、中、低分别用1、2、3表示为非定距数据



## 共享文本格式文件数据

### 文本文件的格式类型

SPSS规定：默认的文本文件的扩展名应为.dat。同时对文本文件中的数据排列方式也进行了规定，即按数据的排列方式分为文本文件固定格式的文本文件和自由格式的文本文件。

固定格式文本文件：一个个案数据可以占若干行；每个个案数据的每个变量值的起始列和终止列必须是固定不变的；数据项之间可以有分隔符，也可以没有。分隔符一般是逗号、空格等

自由格式文本文件：一个个案数据可以占若干行；每个个案数据的每个变量值的起始列和终止列可以不固定；数据项之间必须有一个分隔符。分隔符可以是逗号、空格、Tab键以及其他的用户自定义分隔符



## 个案排序

当排序变量只有一个时的排序称为单值排序，即：按照排序变量取值的大小次序对个案数据重新整理后显示。当排序变量是多个的排序称为多重排序。多重排序的第一个排序变量称为主排序变量，其他排序变量依次称为第二排序变量、第三排序变量等



## 个案选取

### 选择符合条件的个案

当选取符合一定条件的个案要求用户给出一个SPSS条件表达式，程序会自动对数据编辑窗口的所有个案进行条件判断，对满足条件的数据，将自动选取出来，而判断条件为假的数据将被剔除出去



###随机选取个案

随机选取个案就是度数据编辑窗口中的所有个案进行随机筛选

#### 近似选取

需给出一个百分比数值，SPSS按照这个比例，随机抽取相应百分比数目的个案

#### 精确选取

需要用户给出两个参数：第一个参数是希望选取的个案数；第二个是指定在前几个个案中选取

#### 选取某一区域内的个案

抽取一定范围内的全部个案，需要给出这个范围的上、下界的个案号码

#### 使用过滤变量选取个案

要求用户指定一个已存在的个案选取标准，变量值为0或系统缺失值的个案将被自动剔除掉，而其余的个案将自动选中



## SPSS算术表达式

1.字符型常量应用单引号引起来

2.SPSS变量名是指那些已存在于数据编辑窗口中的现有的变量名

3.SPSS的算术运算符主要包括：加减乘除，乘方（**）

4.SPSS算术表达式中的常量和变量的类型应该是一致的，否则无法计算

5.在SPSS中，算术表达式的计算是针对于每个个案的

6.存放SPSS算术表达式结果的变量，变量类型应与计算结果的数据类型一致



## SPSS函数

算术函数、统计函数、分布函数、逻辑函数、字符串函数、日期时间函数、缺失值函数和其他函数

具体见《统计分析与SPSS的应用》——薛薇（P39）



## 数据分组

指定分组变量；定义分组变量的分组区间；指定一个存放分组结果的标志变量，标志每个个案所属组的组号

### 数据自动分组

### 数据手工分组



## 插入SPSS文本

当需要在分析结果中插入一些自己的评述观点时，可以在相应子树项处选定，从**插入**-**新建文本**中输入相应文字



## 格式对齐

为使分析结果和报表打印出来后有较好的视觉效果，可以使用对齐处理：选中相应的子树或子树项，在**格式**中选择需要的对齐方式



## 改变索引输出区的显示样式

### 改变索引树的显示字体

**查看**-**大纲字体**

### 改变索引树的显示大小

**查看**-**大纲大小**



## 添加表格组成部分

使表格进入编辑状态，通过**Insert**进行输入



## 隐藏显示表格中内容

将需要隐藏的内容选定，通过**查看**-**隐藏**将其隐藏

当需要查看所有项目时，点击**显示所有选项**



## 表格行列互换

需要先使表格进入编辑状态

1.通过**透视**-**行列互置**完成

2.通过**透视**-**转到层（列）**

3.通过**透视**-**透视托盘**，在通过鼠标移动相应的图标完成



## 修改表格单元的外观

可以进行更改显示字体、数据显示格式、数据对齐方式等属性

1.使被处理的表格进入编辑状态

2.选中欲修改外观的单元

3.**格式**-**修改单元属性**



## 修改表格的外观和样式

1.使被处理的表格处于编辑状态

2.**格式**-**表属性**

或

1.使被处理的表格处于编辑状态

2.**格式**-**表外观**



## 峰度

用来描述某变量所有取值分布形态陡缓程度的统计量（相对于正太分布而言）
$$
Kurtosis = \frac{1}{n-1}\sum_{i=1}^{n}(x_i-\overline{x})^4/SD^4-3
$$
当峰度为0时，表示数据分布于正太分布的陡缓程度相同；峰度大于0表示比正太分布高峰要更陡峭，为尖峰顶；峰度大于0表示比正太分布的高峰要平坦，为平峰顶



## 偏度

用来描述某变量所有取值分布形态的对称性的统计量
$$
Skewness = \frac{1}{n-1}\sum_{i=1}^n(x_i-\overline{x})^3/SD^3
$$
与正太分布相比，偏度为0表示其数据分布形态与正太分布偏度相同，左右对称；偏度大于0表示正偏差数值较大，为正偏或称为右偏，有一条长尾拖在右边；偏度小于0则相反；偏度的绝对值越大表示数据的分布形态的偏斜程度越大



## 多重响应

对于多选题，可以使用二分法，即将题目中的子题目分为多个单选题，此时需要告诉SPSS该题其实是多选题；设定方式为在**分析→多重响应→二分法**中进行

但当选项较多且规定可选项较少时，采用上述方法较为浪费空间，此时可将其值设定为值标签并将所有选项输入，最后再用多重响应的方法将输入的数据组合，但此时需要选定**类别**项



## 假设检验

1.根据推断检验的目标，对待推断的总体参数或分布作一个基本假设$H_0$

2.利用收集到的样本数据和基本假设计算某检验统计量，该统计量服从或近似服从某统计分布

3.根据该统计量的值得到对应的相伴概率值。某统计量的相伴概率值是指该检验统计量在某个特定的极端区域取值在$H_0$成立时的概率

4.做出片段。用户给出一个显著性水平$\alpha$。如果相伴概率值小于或等于用户给定的显著性水平，则拒绝$H_0$，否则，如果相伴概率值大于用户给定的显著性水平，则不能拒绝



### 两独立样本t检验

#### 前提要求

1.两样本应是相互独立的，即从一总体中抽取一批样本对从另一总体中抽取一批样本没有任何影响，两组样本的个案数目可以不同，个案顺序可以随意调整

2.样本来自的两个总体应服从正态分布



#### 基本实现思路

1.利用F检验判断两总体的方差是否相等

依然使用假设检验的方法，假设**$H_{0}：两总体方差无差异$**；首先，对来自两个不同总体的样本分别计算样本均值。计算每个样本与本组样本均值的差，并对差取绝对值。于是得到两组绝对值差值序列；再利用单因素方差分析方法，判断两组绝对差值序列之间是否存在显著差异，即判断平均离差是否存在显著差异，从而间接判断两组方差是否存在显著差异

2.根据前一步的判断结果决定t统计量和自由度的计算公式，进而对t检验的结论作出判断

根据前一步的判断结果决定t统计量和自由度的计算公式：

1）在两总体方差未知且相等的情况下，t统计量计算公式：
$$
t=\frac{\overline{\chi}_1-\overline{\chi}_2}{\sqrt{S_{p}^2/n_1+S_{p}^2/n_2}}
$$
式中：
$$
S_{p}^2=\frac{(n_1-1)S_1^2+(n_2-1)S_2^2}{n_1+n_2-1}
$$
这里，t统计量服从$n_1+n_2-2$个自由度的t分布



2）在两总体方差未知且不相等的情况下，t统计量计算公式：


$$
t=\frac{\overline{\chi}_1-\overline{\chi}_2}{\sqrt{S_{p}^2/n_1+S_{p}^2/n_2}}
$$
这里，t统计量仍服从t分布，但自由度采用修正的自由度：
$$
f=\frac{(\frac{S_1^2}{n_1}+\frac{S_2^2}{n_2})^2}{\frac{(\frac{S_1^2}{n_1})^2}{n_1}+\frac{(\frac{S_2^2}{n_2})^2}{n_2}}
$$



### 两配对样本t检验

#### 前提要求

1.两样本应是配对的：观察值数目相同；两样本的观察值的顺序不能随意更改

2.样本来自的两个总体应服从正态分布



## 非假设检验

### 卡方检验

根据样本数据推断总体的分布于期望分布或某一理论分布是否有显著差异



### 二项分布检验

在样本数小于等于30时，按照计算二项分布概率的公式进行计算；在样本数大于30时，计算的是Z统计量，认为在零假设下，Z统计量近似服从正态分布。Z统计量的计算公式为：
$$
Z = \frac{K\pm0.5-nP}{\sqrt{nP(1-P)}}
$$
式中：K是观察值取值为指出检验值的样本个数，P为检验概率，n为样本总数。当K小于$n/2$时，取加号，K大于$n/2$时，取减号



### 单样本K-S检验

利用样本数据推断总体是否服从某一理论分布，适用于探索连续型随机变量的分布形态



### 单样本变量值随机性检验

对某变量的变量值出现是否随机进行检验



## 单样本非参数检验方法的比较

在上面的四种单样本参数检验中，前三种方法均属于拟合性检验的范畴。因此，当检验样本来自的总体是否服从某种理论分布时，可以选用前三种方法中的一种。但在实际使用中，应注意这些检验方法对数据的要求。

1.卡方检验一般要求待检验样本有较大的样本容量，比较适合于一个因素的多项分类的数据分析

2.二项分布检验只能作二项分布检验

3.单样本K-S检验比较适合于连续型数据的分析，其检验功效是比较强的



## 两独立样本非参数检验

### 曼-惠特尼U检验

通过平均秩的研究来实现推断。先将两个数据$[X_1,X_2,\cdots,X_m]$和$[Y_1,Y_2,\cdots,Y_n]$混合并按升序排序，求出各个数据各自的秩$R_i$，再对两个数据的秩求平均，得到两个平均秩$W_X/m$和$W_Y/n$，若两个平均秩相差甚远，则可以怀疑假设不成立

且该方法还对每个$[X_1,X_2,\cdots,X_m]$每个秩优于$[Y_1,Y_2,\cdots,Y_n]$每个秩的个数，$U_1$以及$[Y_1,Y_2,\cdots,Y_n]$每个秩优于$[X_1,X_2,\cdots,X_m]$每个秩的个数$U_2$进行比较，若相距较大，则怀疑假设

SPSS将自动计算$Wilcoxon\ W$统计量和$Mann-Whiteny\ U$统计量，若m<n,则$Wilcoxon\ W=W_Y$;若m>n，则$Wilcoxon\ W=W_X$；若m=n，则$Wilcoxon\ W$为第一个观察值所属样本组的W值



$Mann-Whiteny\ U$统计量计算式为：
$$
U=W-\frac{1}{2}n(n+1)
$$
式中：W即为$Wilcoxon\ W$,n取值为W对应组的样本容量

此时近似服从正态分布的Z统计量计算式为：
$$
Z=\frac{U-\frac{1}{2}mn}{\sqrt{\frac{1}{12}mn(m+n+1)}}
$$
在样本个数小于30时，应以U统计量的相伴概率作为判断标准；在样本个数大于30时，属于大样本情况下，应以Z统计量的相伴概率作为判断标准



### 两独立样本的K-S检验

不仅能够检验单样本是否服从某一理论分布，还能够对两独立样本的总体分布情况进行比较

基本思想与前述方法一致，但此处处理的是观察值的秩，而非观察值本身。首先，将两组样本混合按升序排序，然后分别计算两组样本秩的累计频数和每个点上的累计频率；最后，将两个累计频率相减，得到差值序列数据

该方法适用于大样本情况下



### 两独立样本的游程检验

单样本的游程检验是用来检验变量值的出现是否随机，两独立变量的游程检验则用来检验样本来自的两独立总体的分布是否存在显著差异

先将两组样本混合并按升序排序，在数据排序的同时，两组样本的每个观察值对应的样本组标志值序列也随之重新排列；随后，对这个标志值序列按前面讨论的方法求游程



### 两独立样本的极端反应检验

将一个样本作为控制样本，另一个样本作为实验样本。以控制样本作为对照，检验实验样本是否存在极端反应。如果实验样本不存在极端反应，则认为两独立总体分布无显著差异

首先，将两组样本混合并按升序排序；然后，找出控制样本最低秩和最高秩之间包含的观察值个数，称为跨度。为控制极端值对分析结果的影响，也可以先去掉控制样本两个最极端的观察值后再求跨度，这个跨度称为截头跨度。当跨度或截头跨度很小，则应是两样本数据无法充分混合后的结果，可以认为实验样本存在极端反应



## 多独立样本非参数检验

### 多独立样本的中位数检验

通过对多组样本数据的分析推断多个独立总体的分布是否存在显著差异

基本思想：如果多组样本的中位数无显著差异，或者说，如果多组独立样本有共同的中位数，那么，这个中位数应处于每组样本数据的中间位置

首先，将多组样本数据混合并按升序排序，求出混合样本数据中的中位数，并假设它是一个共同的中位数，然后分别计算每组样本中大于或小于这个共同中位数的样本数



### 多独立样本的K-W检验

基本方法：将多组样本数混合按升序排序，并求出每个观察值的秩，然后，对多组样本的秩求平均数



###多独立总体的$Jonkheere-Terpstra$检验

基本思想方法与两独立样本的曼-惠特尼U检验比较类似，也是计算一组样本的观察值小于其他组样本的观察值个数



## 两配对样本非参数检验

是在总体分布不很了解的情况下，对样本来自的两个相关配对总体的分布进行推断

### $McNemar$变化显著性检验

将研究对象自身作为对照者，检验其“前后”的变化是否显著

**注意：**SPSS两配对样本$McNemar$变化显著性检验要求待校验的两组样本的观察值是二值数据，因此，分析具有一定的局限性



### 两配对样本的符号（Sign）检验

基本思想：利用正、负号个数的多少来进行检验

先分别将第二组样本的各个观察值减去第一组样本的各个观察值，如果差值为正，则记号为正，差值为负，记为符号；然后，计算正号的个数$S_+$和负号的个数$S_-$，两者之和为总观察值个数n



### 两配对样本的Wilcoxon符号平均秩检验

基本思想：先按照符号检验的方法，分别将第二组样本的各个观察值减去第一组样本的各个观察值，如果插值为正，则记为正号，插值为负，记为负号，并同时保存绝对差值数据；然后，将绝对差值数据按升序排序，并求出相应的秩；最后，分别计算正号秩总和$W^+$、负号秩总和$W^-$以及正号平均秩和负号平均秩



## 多配对样本参数检验

### 多配对样本的$Cochran\ Q$检验

其所处理的样本数据要求是二值的



### 多配对样本的$Friedman$检验

用秩实现对多个配对总体分布进行检验

其要求数据是定距的，使该方法有了较大的适用范围

基本方法：先以观察值（行）为单位，将各个样本数据按行升序排序求得各样本数据在各自行中的秩，然后，分别计算各样本的秩总和，平均秩



### 多配对样本的Kendall协同系数检验

主要用在分析评判者的评判标准是否一致公平，将每个评判对象的分数都看做是来自多个配对总体的样本



##方差分析

分析控制变量的不同水平是否对观察变量产生了显著影响

### 单因素方差分析

实质采用了统计推断的方法，目的是通过实验数据（样本数据）研究观察变量在一个控制变量中的若干个不同水平下，其各个总体在分布上是否存在显著差异

前提要求：不同水平下的各总体应服从方差相同的正态分布，因此方差分析问题就转换成研究不同水平下各总体均值有无显著差异的问题

#### 前提检验

由于方差分析的前提是各水平下的总体服从方差相等的正态分布。对正态分布的要去不是很严格，但是对方差相等的要求比较严格，所以，必须对方差分析的前提进行检验

方法采用$Homogeneity-of-variance$，具体检验方法与独立样本t检验中的方差相等检验方法完全相同

#### 单因素方差分析的多重比较检验

即对该因素量值大小对结果影响的分析



### 均值比较

基本思路：

1.用户应先指定一个或多个变量作为分组变量，并按分组变量的不同取值对个案数据进行分组。如果分组变量有多个，还应指定这些分组变量之间的层次关系。层次关系可以是同层次的或多层次的。同层次意味着将按照各分组变量的不同取值分别对个案作分组；多层次意味着将首先按第一分组变量分组，然后对各分组下个案再按第二分组变量的不同取值继续分组，这样逐层向下细分。如果从单因素方差分析的角度来看，这里第一分组变量就是控制变量，各个分组就是控制变量下的各个水平

2.指定一个变量作为汇总变量，并计算该汇总变量在各分组下的基本描述统计量。如果从单因素方差分析的角度看，这里汇总变量就是观察变量

3.对第一分组变量各分组下的汇总变量均值有无显著差异作统计检验。如果从单因素方差分析的角度看，就是对控制变量不同水平下观察变量的均值是否有显著差异进行判断



### 多因素方差分析和协方差分析

控制变量个数是两个或两个以上，研究目的是要分析多个控制变量的作用、多个控制变量交互作用、以及其他随机因素作用是否对观察变量的分布产生显著影响

#### 多因素方差分析的基本思路

由于多因素方差分析既要分析多个控制变量独立作用对观察变量的影响，又要分析多个控制变量交互作用对观察变量的影响和其他随机因素对观察变量的影响，因此，它将观察变量总的变差平方和分解成由多个控制变量单独作用引起的、由多个控制变量交互影响引起的、由其他随机因素引起的三个部分



#### 协方差分析的基本思路

协方差分析是将那些很难控制的因素作为协变量，在排除协变量影响的条件下，分析控制变量对观察变量的影响，从而更加准确地对控制因素进行评价

